(()=>{"use strict";var t={134:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(o,r){function n(t){try{a(s.next(t))}catch(t){r(t)}}function h(t){try{a(s.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(n,h)}a((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Chroma=void 0;const o=i(371);e.Chroma=class{constructor(){this.keyboard=new o.Matrix(22,6)}init(t){return s(this,void 0,void 0,(function*(){if(this.uri)return!0;try{const e=yield this.request({url:"http://localhost:54235/razer/chromasdk",body:{title:t.title,description:t.description,author:{name:t.authorName,contact:t.authorContact},device_supported:t.supportedDevices,category:t.category}});return this.uri=e.uri,this.sessionId=e.sessionid,this.interval=setInterval((()=>s(this,void 0,void 0,(function*(){yield this.request({method:"PUT",path:"/heartbeat"})}))),1e3),!0}catch(t){return console.error(t),!1}}))}uninitialize(){return s(this,void 0,void 0,(function*(){this.uri&&(yield this.request({method:"DELETE"}),clearInterval(this.interval))}))}drawKeyboard(t,e,i){return s(this,void 0,void 0,(function*(){this.keyboard.clear(),this.keyboard.copy(t,e,i),yield this.request({path:"/keyboard",method:"PUT",body:{effect:"CHROMA_CUSTOM",param:this.keyboard.data}})}))}request(t){return s(this,void 0,void 0,(function*(){if(!t.url&&!this.uri)return;const e={method:t.method||"POST"};t.body&&(e.headers={"content-type":"application/json"},e.body=JSON.stringify(t.body));let i=t.url||this.uri;t.path&&(i+=t.path);const s=yield fetch(i,e);return yield s.json()}))}}},607:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(o,r){function n(t){try{a(s.next(t))}catch(t){r(t)}}function h(t){try{a(s.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(n,h)}a((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const o=i(134),r=i(970);s(void 0,void 0,void 0,(function*(){JSON.stringify({title:"Razer Snake",description:"Snake Game for Razer Chroma Keyboards",author:{name:"Diego Iáñez Ávila",contact:"https://github.com/diegodan1893"},device_supported:["keyboard"],category:"game"});const t=new o.Chroma;(yield t.init({title:"Razer Snake",description:"Snake Game for Razer Chroma Keyboards",authorName:"Diego Iáñez Ávila",authorContact:"https://github.com/diegodan1893",supportedDevices:["keyboard"],category:"game"}))&&new r.SnakeBoard(t,11,4,2,1).startGame()}))},371:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix=void 0,e.Matrix=class{constructor(t,e,i=0){this.width=t,this.height=e,this.fillValue=i,this._data=new Array(e).fill(0).map((()=>new Array(t).fill(i)))}get data(){return this._data}clear(){for(let t=0;t<this.height;++t)for(let e=0;e<this.width;++e)this._data[t][e]=this.fillValue}set(t,e,i){this._data[e][t]=i}copy(t,e=0,i=0){t._data.forEach(((t,s)=>t.forEach(((t,o)=>this._data[s+i][o+e]=t))))}}},726:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.randomInRange=void 0,e.randomInRange=(t,e)=>Math.random()*(e-t)+t},492:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Food=void 0;const s=i(726),o=i(425);e.Food=class{constructor(t){this.board=t,this.position={x:0,y:0},this.regenerate()}update(){}draw(t){t.set(this.position.x,this.position.y,16777215)}testCollision(t){return this.position.x==t.x&&this.position.y==t.y}handleCollision(t){t instanceof o.Snake&&(t.grow(1),this.regenerate())}regenerate(){let t;do{t={x:Math.floor((0,s.randomInRange)(0,this.board.width)),y:Math.floor((0,s.randomInRange)(0,this.board.height))}}while(this.board.query(t));this.position=t}}},425:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.Snake=void 0,function(t){t[t.None=0]="None",t[t.Up=1]="Up",t[t.Down=2]="Down",t[t.Left=3]="Left",t[t.Right=4]="Right"}(i||(i={}));class s{constructor(t){this.maxLength=t,this.buffer=new Array(t),this.start=0,this.end=0,this.length=0}enqueue(t){this.buffer[this.end-1]!==t&&this.length!==this.maxLength&&(++this.length,this.buffer[this.end]=t,this.end=(this.end+1)%this.maxLength)}dequeue(){if(0===this.length)return;--this.length;const t=this.buffer[this.start];return this.start=(this.start+1)%this.maxLength,t}}class o{constructor(t,e,o,r){this.board=t,this.snake=e,this.position=o,this.prev=r,this.direction=i.None,r||(this.inputBuffer=new s(3)),this.alive=!0}update(){if(this.processInput(),this.next&&this.next.update(),this.snake.alive){const t=this.direction;if(this.prev&&(this.direction=this.prev.direction),t===i.None)return;const e=this.getNextPosition(t);if(!this.prev){const t=this.board.query(e);t&&t.handleCollision(this.snake)}this.position=e}else this.alive&&(this.prev?this.alive=this.prev.alive:this.alive=!1)}draw(t){t.set(this.position.x,this.position.y,this.alive?65280:255),this.next&&this.next.draw(t)}testCollision(t){return t.x===this.position.x&&t.y===this.position.y||!!this.next&&this.next.testCollision(t)}handleCollision(t){this.snake.kill(),this.board.loseGame()}handleInput(t){if(!this.inputBuffer)return;let e=this.direction;switch(t){case"ArrowUp":e=i.Up;break;case"ArrowDown":e=i.Down;break;case"ArrowRight":e=i.Right;break;case"ArrowLeft":e=i.Left}this.inputBuffer.enqueue(e)}grow(t){t<=0||(this.next?this.next.grow(t):(this.next=new o(this.board,this.snake,this.position,this),this.next.grow(t-1)))}getNextPosition(t){const e={x:this.position.x,y:this.position.y};switch(t){case i.None:break;case i.Up:e.y=(e.y+this.board.height-1)%this.board.height;break;case i.Down:e.y=(e.y+1)%this.board.height;break;case i.Left:e.x=(e.x+this.board.width-1)%this.board.width;break;case i.Right:e.x=(e.x+1)%this.board.width}return e}processInput(){if(!this.inputBuffer)return;let t=this.inputBuffer.dequeue(),e=!1;for(;t&&!e;){const i=this.getNextPosition(t);this.next&&this.next.position.x===i.x&&this.next.position.y===i.y?t=this.inputBuffer.dequeue():(this.direction=t,e=!0)}}}e.Snake=class{constructor(t,e,i){this.board=t,this.head=new o(t,this,e,void 0),this.grow(i-1),this._alive=!0}get alive(){return this._alive}update(){this.head.update()}draw(t){this.head.draw(t)}testCollision(t){return this.head.testCollision(t)}handleCollision(t){this.head.handleCollision(t)}handleInput(t){this.head.handleInput(t)}grow(t=1){this.head.grow(t)}kill(){this._alive=!1}}},970:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SnakeBoard=void 0;const s=i(371),o=i(425),r=i(492);var n;!function(t){t[t.Stopped=0]="Stopped",t[t.Playing=1]="Playing",t[t.GameOver=2]="GameOver"}(n||(n={})),e.SnakeBoard=class{constructor(t,e,i,o,r){this.chroma=t,this._width=e,this._height=i,this.offsetX=o,this.offsetY=r,this.entities=[],this.state=n.Stopped,this.screen=new s.Matrix(this.width,this.height)}get width(){return this._width}get height(){return this._height}update(){this.entities.forEach((t=>t.update()))}draw(){this.screen.clear(),this.entities.forEach((t=>t.draw(this.screen))),this.chroma.drawKeyboard(this.screen,this.offsetX,this.offsetY)}query(t){return this.entities.find((e=>e.testCollision(t)))}startGame(){this.state!==n.Stopped&&this.stopGame(),this.entities=[new o.Snake(this,{x:1,y:Math.floor(this.height/2)},3),new r.Food(this)],this.state=n.Playing,this.inputAbortController=new AbortController,document.addEventListener("keydown",(t=>{"Backspace"===t.key?this.startGame():this.entities.forEach((e=>{e.handleInput&&e.handleInput(t.key)}))}),{signal:this.inputAbortController.signal}),this.interval=setInterval((()=>{this.update(),this.draw()}),200)}stopGame(){this.state=n.Stopped,this.inputAbortController&&this.inputAbortController.abort(),this.interval&&(clearInterval(this.interval),this.interval=void 0)}loseGame(){this.state=n.GameOver}}}},e={};!function i(s){var o=e[s];if(void 0!==o)return o.exports;var r=e[s]={exports:{}};return t[s].call(r.exports,r,r.exports,i),r.exports}(607)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwibWFwcGluZ3MiOiIrYUFBQSxlQW9CQSxlQU9DQSxjQUNDQyxLQUFLQyxTQUFXLElBQUksRUFBQUMsT0FBTyxHQUFJLEVBQ2hDLENBRU1DLEtBQUtDLEcseUNBQ1YsR0FBSUosS0FBS0ssSUFFUixPQUFPLEVBR1IsSUFDQyxNQUFNQyxRQUFpQk4sS0FBS08sUUFBUSxDQUNuQ0MsSUFyQ3FCLHlDQXNDckJDLEtBQU0sQ0FDTEMsTUFBT04sRUFBWU0sTUFDbkJDLFlBQWFQLEVBQVlPLFlBQ3pCQyxPQUFRLENBQ1BDLEtBQU1ULEVBQVlVLFdBQ2xCQyxRQUFTWCxFQUFZWSxlQUV0QkMsaUJBQWtCYixFQUFZYyxpQkFDOUJDLFNBQVVmLEVBQVllLFlBY3hCLE9BVkFuQixLQUFLSyxJQUFNQyxFQUFTRCxJQUNwQkwsS0FBS29CLFVBQVlkLEVBQVNlLFVBRTFCckIsS0FBS3NCLFNBQVdDLGFBQVksSUFBWSxFQUFELHNDQUNoQ3ZCLEtBQUtPLFFBQVEsQ0FDbEJpQixPQUFRLE1BQ1JDLEtBQU0sY0FFUixLQUFHLE1BRUksQyxDQUNOLE1BQU9DLEdBRVIsT0FEQUMsUUFBUUQsTUFBTUEsSUFDUCxDLENBRVQsRyxDQUVNRSxlLHlDQUNBNUIsS0FBS0ssWUFJSkwsS0FBS08sUUFBUSxDQUFFaUIsT0FBUSxXQUM3QkssY0FBYzdCLEtBQUtzQixVQUNwQixHLENBRU1RLGFBQWFDLEVBQWVDLEVBQWlCQyxHLHlDQUNsRGpDLEtBQUtDLFNBQVNpQyxRQUVkbEMsS0FBS0MsU0FBU2tDLEtBQUtKLEVBQU9DLEVBQVNDLFNBRTdCakMsS0FBS08sUUFBUSxDQUNsQmtCLEtBQU0sWUFDTkQsT0FBUSxNQUNSZixLQUFNLENBQ0wyQixPQUFRLGdCQUNSQyxNQUFPckMsS0FBS0MsU0FBU3FDLE9BR3hCLEcsQ0FFTS9CLFFBQVFnQyxHLHlDQUNiLElBQUtBLEVBQVEvQixNQUFRUixLQUFLSyxJQUN6QixPQUdELE1BQU1tQyxFQUEyQixDQUNoQ2hCLE9BQVFlLEVBQVFmLFFBQVUsUUFHdkJlLEVBQVE5QixPQUNYK0IsRUFBWUMsUUFBVSxDQUNyQixlQUFnQixvQkFHakJELEVBQVkvQixLQUFPaUMsS0FBS0MsVUFBVUosRUFBUTlCLE9BRzNDLElBQUlELEVBQU0rQixFQUFRL0IsS0FBT1IsS0FBS0ssSUFDMUJrQyxFQUFRZCxPQUNYakIsR0FBTytCLEVBQVFkLE1BR2hCLE1BQU1uQixRQUFpQnNDLE1BQU1wQyxFQUFLZ0MsR0FDbEMsYUFBYWxDLEVBQVN1QyxNQUN2QixHLHlZQ3JIRCxlQUNBLFNBRXlCLE9BQUQsNkJBQ1ZILEtBQUtDLFVBQVUsQ0FDM0JqQyxNQUFPLGNBQ1BDLFlBQWEsd0NBQ2JDLE9BQVEsQ0FDUEMsS0FBTSxvQkFDTkUsUUFBUyxtQ0FFVkUsaUJBQWtCLENBQUMsWUFDbkJFLFNBQVUsU0FSWCxNQVdNMkIsRUFBUyxJQUFJLEVBQUFDLGNBQ0dELEVBQU8zQyxLQUFLLENBQ2pDTyxNQUFPLGNBQ1BDLFlBQWEsd0NBQ2JHLFdBQVksb0JBQ1pFLGNBQWUsa0NBQ2ZFLGlCQUFrQixDQUFDLFlBQ25CQyxTQUFVLFdBSVMsSUFBSSxFQUFBNkIsV0FBV0YsRUFBUSxHQUFJLEVBQUcsRUFBRyxHQUN6Q0csV0FFYixHLCtFQzdCQSxlQUdDbEQsWUFDU21ELEVBQ0FDLEVBQ0FDLEVBQW9CLEdBRnBCLEtBQUFGLE1BQUFBLEVBQ0EsS0FBQUMsT0FBQUEsRUFDQSxLQUFBQyxVQUFBQSxFQUVScEQsS0FBS3FELE1BQVEsSUFBSUMsTUFBTUgsR0FDckJJLEtBQUssR0FDTEMsS0FBSSxJQUFNLElBQUlGLE1BQU1KLEdBQU9LLEtBQUtILElBQ25DLENBRUlkLFdBQ0gsT0FBT3RDLEtBQUtxRCxLQUNiLENBRUFuQixRQUNDLElBQUssSUFBSXVCLEVBQUksRUFBR0EsRUFBSXpELEtBQUttRCxTQUFVTSxFQUNsQyxJQUFLLElBQUlDLEVBQUksRUFBR0EsRUFBSTFELEtBQUtrRCxRQUFTUSxFQUNqQzFELEtBQUtxRCxNQUFNSSxHQUFHQyxHQUFLMUQsS0FBS29ELFNBRzNCLENBRUFPLElBQUlELEVBQVdELEVBQVdHLEdBQ3pCNUQsS0FBS3FELE1BQU1JLEdBQUdDLEdBQUtFLENBQ3BCLENBRUF6QixLQUFLMEIsRUFBZ0I3QixFQUFrQixFQUFHQyxFQUFrQixHQUMzRDRCLEVBQU9SLE1BQU1TLFNBQVEsQ0FBQ0MsRUFBS04sSUFDMUJNLEVBQUlELFNBQ0gsQ0FBQ0YsRUFBT0YsSUFBTzFELEtBQUtxRCxNQUFNSSxFQUFJeEIsR0FBU3lCLEVBQUkxQixHQUFXNEIsS0FHekQsRSxzRkNoQ1ksRUFBQUksY0FBZ0IsQ0FBQ0MsRUFBZUMsSUFDckNDLEtBQUtDLFVBQVlGLEVBQU1ELEdBQVNBLEMsK0VDSHhDLGVBR0EsU0FLQSxhQUdDbEUsWUFBb0JzRSxHQUFBLEtBQUFBLE1BQUFBLEVBQ25CckUsS0FBS3NFLFNBQVcsQ0FBRVosRUFBRyxFQUFHRCxFQUFHLEdBQzNCekQsS0FBS3VFLFlBQ04sQ0FFQUMsU0FBVSxDQUVWQyxLQUFLQyxHQUNKQSxFQUFPZixJQUFJM0QsS0FBS3NFLFNBQVNaLEVBQUcxRCxLQUFLc0UsU0FBU2IsRUFiekIsU0FjbEIsQ0FFQWtCLGNBQWNMLEdBQ2IsT0FBT3RFLEtBQUtzRSxTQUFTWixHQUFLWSxFQUFTWixHQUFLMUQsS0FBS3NFLFNBQVNiLEdBQUthLEVBQVNiLENBQ3JFLENBRUFtQixnQkFBZ0JDLEdBQ1hBLGFBQWtCLEVBQUFDLFFBQ3JCRCxFQUFPRSxLQUFLLEdBQ1ovRSxLQUFLdUUsYUFFUCxDQUVRQSxhQUNQLElBQUlTLEVBRUosR0FDQ0EsRUFBYyxDQUNidEIsRUFBR1MsS0FBS2MsT0FBTSxJQUFBakIsZUFBYyxFQUFHaEUsS0FBS3FFLE1BQU1uQixRQUMxQ08sRUFBR1UsS0FBS2MsT0FBTSxJQUFBakIsZUFBYyxFQUFHaEUsS0FBS3FFLE1BQU1sQixnQkFFbkNuRCxLQUFLcUUsTUFBTWEsTUFBTUYsSUFFMUJoRixLQUFLc0UsU0FBV1UsQ0FDakIsRSxjQ3JDRCxJQUFLRyxFLGdFQUFMLFNBQUtBLEdBQ0osbUJBQ0EsZUFDQSxtQkFDQSxtQkFDQSxvQkFDQSxDQU5ELENBQUtBLElBQUFBLEVBQVMsS0FRZCxNQUFNQyxFQU1MckYsWUFBb0JzRixHQUFBLEtBQUFBLFVBQUFBLEVBQ25CckYsS0FBS3NGLE9BQVMsSUFBSWhDLE1BQU0rQixHQUN4QnJGLEtBQUtpRSxNQUFRLEVBQ2JqRSxLQUFLa0UsSUFBTSxFQUNYbEUsS0FBS3VGLE9BQVMsQ0FDZixDQUVBQyxRQUFRQyxHQUNIekYsS0FBS3NGLE9BQU90RixLQUFLa0UsSUFBTSxLQUFPdUIsR0FLOUJ6RixLQUFLdUYsU0FBV3ZGLEtBQUtxRixjQUt2QnJGLEtBQUt1RixPQUNQdkYsS0FBS3NGLE9BQU90RixLQUFLa0UsS0FBT3VCLEVBQ3hCekYsS0FBS2tFLEtBQU9sRSxLQUFLa0UsSUFBTSxHQUFLbEUsS0FBS3FGLFVBQ2xDLENBRUFLLFVBQ0MsR0FBb0IsSUFBaEIxRixLQUFLdUYsT0FDUixTQUdDdkYsS0FBS3VGLE9BQ1AsTUFBTUUsRUFBUXpGLEtBQUtzRixPQUFPdEYsS0FBS2lFLE9BRy9CLE9BRkFqRSxLQUFLaUUsT0FBU2pFLEtBQUtpRSxNQUFRLEdBQUtqRSxLQUFLcUYsVUFFOUJJLENBQ1IsRUFHRCxNQUFNRSxFQU1MNUYsWUFDU3NFLEVBQ0F1QixFQUNBdEIsRUFDQXVCLEdBSEEsS0FBQXhCLE1BQUFBLEVBQ0EsS0FBQXVCLE1BQUFBLEVBQ0EsS0FBQXRCLFNBQUFBLEVBQ0EsS0FBQXVCLEtBQUFBLEVBUkQsS0FBQUMsVUFBdUJYLEVBQVVZLEtBVW5DRixJQUVKN0YsS0FBS2dHLFlBQWMsSUFBSVosRUFBWSxJQUdwQ3BGLEtBQUtpRyxPQUFRLENBQ2QsQ0FFQXpCLFNBT0MsR0FOQXhFLEtBQUtrRyxlQUVEbEcsS0FBS21HLE1BQ1JuRyxLQUFLbUcsS0FBSzNCLFNBR1B4RSxLQUFLNEYsTUFBTUssTUFBTyxDQUNyQixNQUFNRyxFQUFtQnBHLEtBQUs4RixVQU05QixHQUpJOUYsS0FBSzZGLE9BQ1I3RixLQUFLOEYsVUFBWTlGLEtBQUs2RixLQUFLQyxXQUd4Qk0sSUFBcUJqQixFQUFVWSxLQUVsQyxPQUdELE1BQU1mLEVBQWNoRixLQUFLcUcsZ0JBQWdCRCxHQUV6QyxJQUFLcEcsS0FBSzZGLEtBQU0sQ0FFZixNQUFNUyxFQUFZdEcsS0FBS3FFLE1BQU1hLE1BQU1GLEdBRS9Cc0IsR0FDSEEsRUFBVTFCLGdCQUFnQjVFLEtBQUs0RixNLENBSWpDNUYsS0FBS3NFLFNBQVdVLEMsTUFDTmhGLEtBQUtpRyxRQUVYakcsS0FBSzZGLEtBQ1I3RixLQUFLaUcsTUFBUWpHLEtBQUs2RixLQUFLSSxNQUd2QmpHLEtBQUtpRyxPQUFRLEVBR2hCLENBRUF4QixLQUFLQyxHQUNKQSxFQUFPZixJQUNOM0QsS0FBS3NFLFNBQVNaLEVBQ2QxRCxLQUFLc0UsU0FBU2IsRUFDZHpELEtBQUtpRyxNQXZIa0IsTUFDRCxLQXlIbkJqRyxLQUFLbUcsTUFDUm5HLEtBQUttRyxLQUFLMUIsS0FBS0MsRUFFakIsQ0FFQUMsY0FBY0wsR0FDYixPQUFJQSxFQUFTWixJQUFNMUQsS0FBS3NFLFNBQVNaLEdBQUtZLEVBQVNiLElBQU16RCxLQUFLc0UsU0FBU2IsS0FJL0R6RCxLQUFLbUcsTUFDRG5HLEtBQUttRyxLQUFLeEIsY0FBY0wsRUFJakMsQ0FFQU0sZ0JBQWdCQyxHQUNmN0UsS0FBSzRGLE1BQU1XLE9BQ1h2RyxLQUFLcUUsTUFBTW1DLFVBQ1osQ0FFQUMsWUFBWUMsR0FDWCxJQUFLMUcsS0FBS2dHLFlBQ1QsT0FHRCxJQUFJVyxFQUFlM0csS0FBSzhGLFVBRXhCLE9BQVFZLEdBQ1AsSUFBSyxVQUNKQyxFQUFleEIsRUFBVXlCLEdBQ3pCLE1BQ0QsSUFBSyxZQUNKRCxFQUFleEIsRUFBVTBCLEtBQ3pCLE1BQ0QsSUFBSyxhQUNKRixFQUFleEIsRUFBVTJCLE1BQ3pCLE1BQ0QsSUFBSyxZQUNKSCxFQUFleEIsRUFBVTRCLEtBSzNCL0csS0FBS2dHLFlBQVlSLFFBQVFtQixFQUMxQixDQUVBNUIsS0FBS1EsR0FDQUEsR0FBVSxJQUlWdkYsS0FBS21HLEtBQ1JuRyxLQUFLbUcsS0FBS3BCLEtBQUtRLElBRWZ2RixLQUFLbUcsS0FBTyxJQUFJUixFQUNmM0YsS0FBS3FFLE1BQ0xyRSxLQUFLNEYsTUFDTDVGLEtBQUtzRSxTQUNMdEUsTUFFREEsS0FBS21HLEtBQUtwQixLQUFLUSxFQUFTLElBRTFCLENBRVFjLGdCQUFnQlAsR0FDdkIsTUFBTWQsRUFBYyxDQUFFdEIsRUFBRzFELEtBQUtzRSxTQUFTWixFQUFHRCxFQUFHekQsS0FBS3NFLFNBQVNiLEdBRTNELE9BQVFxQyxHQUNQLEtBQUtYLEVBQVVZLEtBRWQsTUFDRCxLQUFLWixFQUFVeUIsR0FHZDVCLEVBQVl2QixHQUNWdUIsRUFBWXZCLEVBQUl6RCxLQUFLcUUsTUFBTWxCLE9BQVMsR0FBS25ELEtBQUtxRSxNQUFNbEIsT0FDdEQsTUFDRCxLQUFLZ0MsRUFBVTBCLEtBQ2Q3QixFQUFZdkIsR0FBS3VCLEVBQVl2QixFQUFJLEdBQUt6RCxLQUFLcUUsTUFBTWxCLE9BQ2pELE1BQ0QsS0FBS2dDLEVBQVU0QixLQUdkL0IsRUFBWXRCLEdBQ1ZzQixFQUFZdEIsRUFBSTFELEtBQUtxRSxNQUFNbkIsTUFBUSxHQUFLbEQsS0FBS3FFLE1BQU1uQixNQUNyRCxNQUNELEtBQUtpQyxFQUFVMkIsTUFDZDlCLEVBQVl0QixHQUFLc0IsRUFBWXRCLEVBQUksR0FBSzFELEtBQUtxRSxNQUFNbkIsTUFJbkQsT0FBTzhCLENBQ1IsQ0FFUWtCLGVBQ1AsSUFBS2xHLEtBQUtnRyxZQUNULE9BR0QsSUFBSWdCLEVBQVloSCxLQUFLZ0csWUFBWU4sVUFDN0J1QixHQUFnQixFQUVwQixLQUFPRCxJQUFjQyxHQUFlLENBR25DLE1BQU1DLEVBQWVsSCxLQUFLcUcsZ0JBQWdCVyxHQUd4Q2hILEtBQUttRyxNQUNObkcsS0FBS21HLEtBQUs3QixTQUFTWixJQUFNd0QsRUFBYXhELEdBQ3RDMUQsS0FBS21HLEtBQUs3QixTQUFTYixJQUFNeUQsRUFBYXpELEVBS3RDdUQsRUFBWWhILEtBQUtnRyxZQUFZTixXQUg3QjFGLEtBQUs4RixVQUFZa0IsRUFDakJDLEdBQWdCLEUsQ0FLbkIsRUFHRCxjQUlDbEgsWUFBb0JzRSxFQUFtQkMsRUFBbUJpQixHQUF0QyxLQUFBbEIsTUFBQUEsRUFDbkJyRSxLQUFLbUgsS0FBTyxJQUFJeEIsRUFBV3RCLEVBQU9yRSxLQUFNc0UsT0FBVThDLEdBQ2xEcEgsS0FBSytFLEtBQUtRLEVBQVMsR0FFbkJ2RixLQUFLcUgsUUFBUyxDQUNmLENBRUlwQixZQUNILE9BQU9qRyxLQUFLcUgsTUFDYixDQUVBN0MsU0FDQ3hFLEtBQUttSCxLQUFLM0MsUUFDWCxDQUVBQyxLQUFLQyxHQUNKMUUsS0FBS21ILEtBQUsxQyxLQUFLQyxFQUNoQixDQUVBQyxjQUFjTCxHQUNiLE9BQU90RSxLQUFLbUgsS0FBS3hDLGNBQWNMLEVBQ2hDLENBRUFNLGdCQUFnQkMsR0FDZjdFLEtBQUttSCxLQUFLdkMsZ0JBQWdCQyxFQUMzQixDQUVBNEIsWUFBWUMsR0FDWDFHLEtBQUttSCxLQUFLVixZQUFZQyxFQUN2QixDQUVBM0IsS0FBS1EsRUFBaUIsR0FDckJ2RixLQUFLbUgsS0FBS3BDLEtBQUtRLEVBQ2hCLENBRUFnQixPQUNDdkcsS0FBS3FILFFBQVMsQ0FDZixFLHFGQ25TRCxlQUlBLFNBQ0EsU0FFQSxJQUFLQyxHQUFMLFNBQUtBLEdBQ0oseUJBQ0EseUJBQ0EsMEJBQ0EsQ0FKRCxDQUFLQSxJQUFBQSxFQUFTLEtBTWQsbUJBUUN2SCxZQUNTK0MsRUFDQXlFLEVBQ0FDLEVBQ0F4RixFQUNBQyxHQUpBLEtBQUFhLE9BQUFBLEVBQ0EsS0FBQXlFLE9BQUFBLEVBQ0EsS0FBQUMsUUFBQUEsRUFDQSxLQUFBeEYsUUFBQUEsRUFDQSxLQUFBQyxRQUFBQSxFQUVSakMsS0FBS3lILFNBQVcsR0FDaEJ6SCxLQUFLMEgsTUFBUUosRUFBVUssUUFDdkIzSCxLQUFLMEUsT0FBUyxJQUFJLEVBQUF4RSxPQUFPRixLQUFLa0QsTUFBT2xELEtBQUttRCxPQUMzQyxDQUVJRCxZQUNILE9BQU9sRCxLQUFLdUgsTUFDYixDQUVJcEUsYUFDSCxPQUFPbkQsS0FBS3dILE9BQ2IsQ0FFQWhELFNBQ0N4RSxLQUFLeUgsU0FBUzNELFNBQVNlLEdBQVdBLEVBQU9MLFVBQzFDLENBRUFDLE9BQ0N6RSxLQUFLMEUsT0FBT3hDLFFBRVpsQyxLQUFLeUgsU0FBUzNELFNBQVNlLEdBQVdBLEVBQU9KLEtBQUt6RSxLQUFLMEUsVUFFbkQxRSxLQUFLOEMsT0FBT2hCLGFBQWE5QixLQUFLMEUsT0FBUTFFLEtBQUtnQyxRQUFTaEMsS0FBS2lDLFFBQzFELENBRUFpRCxNQUFNWixHQUNMLE9BQU90RSxLQUFLeUgsU0FBU0csTUFBTS9DLEdBQVdBLEVBQU9GLGNBQWNMLElBQzVELENBRUFyQixZQUNLakQsS0FBSzBILFFBQVVKLEVBQVVLLFNBQzVCM0gsS0FBSzZILFdBR043SCxLQUFLeUgsU0FBVyxDQUNmLElBQUksRUFBQTNDLE1BQU05RSxLQUFNLENBQUUwRCxFQUFHLEVBQUdELEVBQUdVLEtBQUtjLE1BQU1qRixLQUFLbUQsT0FBUyxJQUFNLEdBQzFELElBQUksRUFBQTJFLEtBQUs5SCxPQUdWQSxLQUFLMEgsTUFBUUosRUFBVVMsUUFFdkIvSCxLQUFLZ0kscUJBQXVCLElBQUlDLGdCQUNoQ0MsU0FBU0MsaUJBQ1IsV0FDQ0MsSUFDa0IsY0FBZEEsRUFBTTFCLElBRVQxRyxLQUFLaUQsWUFFTGpELEtBQUt5SCxTQUFTM0QsU0FBU2UsSUFDbEJBLEVBQU80QixhQUNWNUIsRUFBTzRCLFlBQVkyQixFQUFNMUIsSSxNQUs3QixDQUFFMkIsT0FBUXJJLEtBQUtnSSxxQkFBcUJLLFNBR3JDckksS0FBS3NCLFNBQVdDLGFBQVksS0FDM0J2QixLQUFLd0UsU0FDTHhFLEtBQUt5RSxNQUFNLEdBQ1QsSUFDSixDQUVBb0QsV0FDQzdILEtBQUswSCxNQUFRSixFQUFVSyxRQUVuQjNILEtBQUtnSSxzQkFDUmhJLEtBQUtnSSxxQkFBcUJNLFFBR3ZCdEksS0FBS3NCLFdBQ1JPLGNBQWM3QixLQUFLc0IsVUFDbkJ0QixLQUFLc0IsY0FBVzhGLEVBRWxCLENBRUFaLFdBQ0N4RyxLQUFLMEgsTUFBUUosRUFBVWlCLFFBQ3hCLEUsR0MzR0dDLEVBQTJCLENBQUMsR0FHaEMsU0FBU0MsRUFBb0JDLEdBRTVCLElBQUlDLEVBQWVILEVBQXlCRSxHQUM1QyxRQUFxQnRCLElBQWpCdUIsRUFDSCxPQUFPQSxFQUFhQyxRQUdyQixJQUFJQyxFQUFTTCxFQUF5QkUsR0FBWSxDQUdqREUsUUFBUyxDQUFDLEdBT1gsT0FIQUUsRUFBb0JKLEdBQVVLLEtBQUtGLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNILEdBR3BFSSxFQUFPRCxPQUNmLENDbkIwQkgsQ0FBb0IsSSIsInNvdXJjZXMiOlsid2VicGFjazovL3R5cGVzY3JpcHQtb24tYnJvd3Nlci1zdGFydGVyLy4vc3JjL2Nocm9tYS9DaHJvbWEudHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1vbi1icm93c2VyLXN0YXJ0ZXIvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1vbi1icm93c2VyLXN0YXJ0ZXIvLi9zcmMvbWF0aC9NYXRyaXgudHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1vbi1icm93c2VyLXN0YXJ0ZXIvLi9zcmMvbWF0aC9SYW5kb20udHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1vbi1icm93c2VyLXN0YXJ0ZXIvLi9zcmMvc25ha2UvRm9vZC50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0LW9uLWJyb3dzZXItc3RhcnRlci8uL3NyYy9zbmFrZS9TbmFrZS50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0LW9uLWJyb3dzZXItc3RhcnRlci8uL3NyYy9zbmFrZS9TbmFrZUJvYXJkLnRzIiwid2VicGFjazovL3R5cGVzY3JpcHQtb24tYnJvd3Nlci1zdGFydGVyL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3R5cGVzY3JpcHQtb24tYnJvd3Nlci1zdGFydGVyL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNYXRyaXggfSBmcm9tIFwiLi4vbWF0aC9NYXRyaXhcIlxyXG5cclxuY29uc3QgUkFaRVJfQ0hST01BX1VSSSA9IFwiaHR0cDovL2xvY2FsaG9zdDo1NDIzNS9yYXplci9jaHJvbWFzZGtcIlxyXG5cclxuaW50ZXJmYWNlIENocm9tYUluaXRPcHRpb25zIHtcclxuXHR0aXRsZTogc3RyaW5nXHJcblx0ZGVzY3JpcHRpb246IHN0cmluZ1xyXG5cdGF1dGhvck5hbWU6IHN0cmluZ1xyXG5cdGF1dGhvckNvbnRhY3Q6IHN0cmluZ1xyXG5cdHN1cHBvcnRlZERldmljZXM6IHN0cmluZ1tdXHJcblx0Y2F0ZWdvcnk6IHN0cmluZ1xyXG59XHJcblxyXG5pbnRlcmZhY2UgUmVxdWVzdE9wdGlvbnMge1xyXG5cdHVybD86IHN0cmluZ1xyXG5cdHBhdGg/OiBzdHJpbmdcclxuXHRtZXRob2Q/OiBcIkdFVFwiIHwgXCJQT1NUXCIgfCBcIlBVVFwiIHwgXCJERUxFVEVcIlxyXG5cdGJvZHk/OiBvYmplY3RcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENocm9tYSB7XHJcblx0cHJpdmF0ZSB1cmk/OiBzdHJpbmdcclxuXHRwcml2YXRlIHNlc3Npb25JZD86IG51bWJlclxyXG5cdHByaXZhdGUgaW50ZXJ2YWw/OiBSZXR1cm5UeXBlPHR5cGVvZiBzZXRUaW1lb3V0PlxyXG5cclxuXHRwcml2YXRlIGtleWJvYXJkOiBNYXRyaXhcclxuXHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHR0aGlzLmtleWJvYXJkID0gbmV3IE1hdHJpeCgyMiwgNilcclxuXHR9XHJcblxyXG5cdGFzeW5jIGluaXQoaW5pdE9wdGlvbnM6IENocm9tYUluaXRPcHRpb25zKTogUHJvbWlzZTxib29sZWFuPiB7XHJcblx0XHRpZiAodGhpcy51cmkpIHtcclxuXHRcdFx0Ly8gQWxyZWFkeSBpbml0aWFsaXplZFxyXG5cdFx0XHRyZXR1cm4gdHJ1ZVxyXG5cdFx0fVxyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXF1ZXN0KHtcclxuXHRcdFx0XHR1cmw6IFJBWkVSX0NIUk9NQV9VUkksXHJcblx0XHRcdFx0Ym9keToge1xyXG5cdFx0XHRcdFx0dGl0bGU6IGluaXRPcHRpb25zLnRpdGxlLFxyXG5cdFx0XHRcdFx0ZGVzY3JpcHRpb246IGluaXRPcHRpb25zLmRlc2NyaXB0aW9uLFxyXG5cdFx0XHRcdFx0YXV0aG9yOiB7XHJcblx0XHRcdFx0XHRcdG5hbWU6IGluaXRPcHRpb25zLmF1dGhvck5hbWUsXHJcblx0XHRcdFx0XHRcdGNvbnRhY3Q6IGluaXRPcHRpb25zLmF1dGhvckNvbnRhY3QsXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0ZGV2aWNlX3N1cHBvcnRlZDogaW5pdE9wdGlvbnMuc3VwcG9ydGVkRGV2aWNlcyxcclxuXHRcdFx0XHRcdGNhdGVnb3J5OiBpbml0T3B0aW9ucy5jYXRlZ29yeSxcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHR9KVxyXG5cclxuXHRcdFx0dGhpcy51cmkgPSByZXNwb25zZS51cmlcclxuXHRcdFx0dGhpcy5zZXNzaW9uSWQgPSByZXNwb25zZS5zZXNzaW9uaWRcclxuXHJcblx0XHRcdHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0YXdhaXQgdGhpcy5yZXF1ZXN0KHtcclxuXHRcdFx0XHRcdG1ldGhvZDogXCJQVVRcIixcclxuXHRcdFx0XHRcdHBhdGg6IFwiL2hlYXJ0YmVhdFwiLFxyXG5cdFx0XHRcdH0pXHJcblx0XHRcdH0sIDEwMDApXHJcblxyXG5cdFx0XHRyZXR1cm4gdHJ1ZVxyXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihlcnJvcilcclxuXHRcdFx0cmV0dXJuIGZhbHNlXHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRhc3luYyB1bmluaXRpYWxpemUoKSB7XHJcblx0XHRpZiAoIXRoaXMudXJpKSB7XHJcblx0XHRcdHJldHVyblxyXG5cdFx0fVxyXG5cclxuXHRcdGF3YWl0IHRoaXMucmVxdWVzdCh7IG1ldGhvZDogXCJERUxFVEVcIiB9KVxyXG5cdFx0Y2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsISlcclxuXHR9XHJcblxyXG5cdGFzeW5jIGRyYXdLZXlib2FyZChpbWFnZTogTWF0cml4LCBvZmZzZXRYOiBudW1iZXIsIG9mZnNldFk6IG51bWJlcikge1xyXG5cdFx0dGhpcy5rZXlib2FyZC5jbGVhcigpXHJcblxyXG5cdFx0dGhpcy5rZXlib2FyZC5jb3B5KGltYWdlLCBvZmZzZXRYLCBvZmZzZXRZKVxyXG5cclxuXHRcdGF3YWl0IHRoaXMucmVxdWVzdCh7XHJcblx0XHRcdHBhdGg6IFwiL2tleWJvYXJkXCIsXHJcblx0XHRcdG1ldGhvZDogXCJQVVRcIixcclxuXHRcdFx0Ym9keToge1xyXG5cdFx0XHRcdGVmZmVjdDogXCJDSFJPTUFfQ1VTVE9NXCIsXHJcblx0XHRcdFx0cGFyYW06IHRoaXMua2V5Ym9hcmQuZGF0YSxcclxuXHRcdFx0fSxcclxuXHRcdH0pXHJcblx0fVxyXG5cclxuXHRhc3luYyByZXF1ZXN0KG9wdGlvbnM6IFJlcXVlc3RPcHRpb25zKSB7XHJcblx0XHRpZiAoIW9wdGlvbnMudXJsICYmICF0aGlzLnVyaSkge1xyXG5cdFx0XHRyZXR1cm5cclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCByZXF1ZXN0SW5pdDogUmVxdWVzdEluaXQgPSB7XHJcblx0XHRcdG1ldGhvZDogb3B0aW9ucy5tZXRob2QgfHwgXCJQT1NUXCIsXHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKG9wdGlvbnMuYm9keSkge1xyXG5cdFx0XHRyZXF1ZXN0SW5pdC5oZWFkZXJzID0ge1xyXG5cdFx0XHRcdFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRyZXF1ZXN0SW5pdC5ib2R5ID0gSlNPTi5zdHJpbmdpZnkob3B0aW9ucy5ib2R5KVxyXG5cdFx0fVxyXG5cclxuXHRcdGxldCB1cmwgPSBvcHRpb25zLnVybCB8fCB0aGlzLnVyaSFcclxuXHRcdGlmIChvcHRpb25zLnBhdGgpIHtcclxuXHRcdFx0dXJsICs9IG9wdGlvbnMucGF0aFxyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCByZXF1ZXN0SW5pdClcclxuXHRcdHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKClcclxuXHR9XHJcbn1cclxuIiwiaW1wb3J0IHsgQ2hyb21hIH0gZnJvbSBcIi4vY2hyb21hL0Nocm9tYVwiXG5pbXBvcnQgeyBTbmFrZUJvYXJkIH0gZnJvbSBcIi4vc25ha2UvU25ha2VCb2FyZFwiXG5cbmNvbnN0IG1haW4gPSBhc3luYyAoKSA9PiB7XG5cdGNvbnN0IGJvZHkgPSBKU09OLnN0cmluZ2lmeSh7XG5cdFx0dGl0bGU6IFwiUmF6ZXIgU25ha2VcIixcblx0XHRkZXNjcmlwdGlvbjogXCJTbmFrZSBHYW1lIGZvciBSYXplciBDaHJvbWEgS2V5Ym9hcmRzXCIsXG5cdFx0YXV0aG9yOiB7XG5cdFx0XHRuYW1lOiBcIkRpZWdvIEnDocOxZXogw4F2aWxhXCIsXG5cdFx0XHRjb250YWN0OiBcImh0dHBzOi8vZ2l0aHViLmNvbS9kaWVnb2RhbjE4OTNcIixcblx0XHR9LFxuXHRcdGRldmljZV9zdXBwb3J0ZWQ6IFtcImtleWJvYXJkXCJdLFxuXHRcdGNhdGVnb3J5OiBcImdhbWVcIixcblx0fSlcblxuXHRjb25zdCBjaHJvbWEgPSBuZXcgQ2hyb21hKClcblx0Y29uc3Qgc3VjY2VzcyA9IGF3YWl0IGNocm9tYS5pbml0KHtcblx0XHR0aXRsZTogXCJSYXplciBTbmFrZVwiLFxuXHRcdGRlc2NyaXB0aW9uOiBcIlNuYWtlIEdhbWUgZm9yIFJhemVyIENocm9tYSBLZXlib2FyZHNcIixcblx0XHRhdXRob3JOYW1lOiBcIkRpZWdvIEnDocOxZXogw4F2aWxhXCIsXG5cdFx0YXV0aG9yQ29udGFjdDogXCJodHRwczovL2dpdGh1Yi5jb20vZGllZ29kYW4xODkzXCIsXG5cdFx0c3VwcG9ydGVkRGV2aWNlczogW1wia2V5Ym9hcmRcIl0sXG5cdFx0Y2F0ZWdvcnk6IFwiZ2FtZVwiLFxuXHR9KVxuXG5cdGlmIChzdWNjZXNzKSB7XG5cdFx0Y29uc3Qgc25ha2VCb2FyZCA9IG5ldyBTbmFrZUJvYXJkKGNocm9tYSwgMTEsIDQsIDIsIDEpXG5cdFx0c25ha2VCb2FyZC5zdGFydEdhbWUoKVxuXHR9XG59XG5cbm1haW4oKVxuIiwiZXhwb3J0IGNsYXNzIE1hdHJpeCB7XHJcblx0cHJpdmF0ZSBfZGF0YTogbnVtYmVyW11bXVxyXG5cclxuXHRjb25zdHJ1Y3RvcihcclxuXHRcdHByaXZhdGUgd2lkdGg6IG51bWJlcixcclxuXHRcdHByaXZhdGUgaGVpZ2h0OiBudW1iZXIsXHJcblx0XHRwcml2YXRlIGZpbGxWYWx1ZTogbnVtYmVyID0gMFxyXG5cdCkge1xyXG5cdFx0dGhpcy5fZGF0YSA9IG5ldyBBcnJheShoZWlnaHQpXHJcblx0XHRcdC5maWxsKDApXHJcblx0XHRcdC5tYXAoKCkgPT4gbmV3IEFycmF5KHdpZHRoKS5maWxsKGZpbGxWYWx1ZSkpXHJcblx0fVxyXG5cclxuXHRnZXQgZGF0YSgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9kYXRhXHJcblx0fVxyXG5cclxuXHRjbGVhcigpIHtcclxuXHRcdGZvciAobGV0IHkgPSAwOyB5IDwgdGhpcy5oZWlnaHQ7ICsreSkge1xyXG5cdFx0XHRmb3IgKGxldCB4ID0gMDsgeCA8IHRoaXMud2lkdGg7ICsreCkge1xyXG5cdFx0XHRcdHRoaXMuX2RhdGFbeV1beF0gPSB0aGlzLmZpbGxWYWx1ZVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRzZXQoeDogbnVtYmVyLCB5OiBudW1iZXIsIHZhbHVlOiBudW1iZXIpIHtcclxuXHRcdHRoaXMuX2RhdGFbeV1beF0gPSB2YWx1ZVxyXG5cdH1cclxuXHJcblx0Y29weShtYXRyaXg6IE1hdHJpeCwgb2Zmc2V0WDogbnVtYmVyID0gMCwgb2Zmc2V0WTogbnVtYmVyID0gMCkge1xyXG5cdFx0bWF0cml4Ll9kYXRhLmZvckVhY2goKHJvdywgeSkgPT5cclxuXHRcdFx0cm93LmZvckVhY2goXHJcblx0XHRcdFx0KHZhbHVlLCB4KSA9PiAodGhpcy5fZGF0YVt5ICsgb2Zmc2V0WV1beCArIG9mZnNldFhdID0gdmFsdWUpXHJcblx0XHRcdClcclxuXHRcdClcclxuXHR9XHJcbn1cclxuIiwiLyoqXHJcbiAqIFJldHVybnMgYSByYW5kb20gbnVtYmVyIGluIHRoZSByYW5nZSBbc3RhcnQsIGVuZClcclxuICovXHJcbmV4cG9ydCBjb25zdCByYW5kb21JblJhbmdlID0gKHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyKTogbnVtYmVyID0+IHtcclxuXHRyZXR1cm4gTWF0aC5yYW5kb20oKSAqIChlbmQgLSBzdGFydCkgKyBzdGFydFxyXG59XHJcbiIsImltcG9ydCB7IE1hdHJpeCB9IGZyb20gXCIuLi9tYXRoL01hdHJpeFwiXHJcbmltcG9ydCB7IHJhbmRvbUluUmFuZ2UgfSBmcm9tIFwiLi4vbWF0aC9SYW5kb21cIlxyXG5pbXBvcnQgeyBWZWN0b3IyIH0gZnJvbSBcIi4uL21hdGgvVmVjdG9yMlwiXHJcbmltcG9ydCB7IEVudGl0eSB9IGZyb20gXCIuL0VudGl0eVwiXHJcbmltcG9ydCB7IFNuYWtlIH0gZnJvbSBcIi4vU25ha2VcIlxyXG5pbXBvcnQgeyBTbmFrZUJvYXJkIH0gZnJvbSBcIi4vU25ha2VCb2FyZFwiXHJcblxyXG5jb25zdCBGT09EX0NPTE9SID0gMHhmZmZmZmZcclxuXHJcbmV4cG9ydCBjbGFzcyBGb29kIGltcGxlbWVudHMgRW50aXR5IHtcclxuXHRwcml2YXRlIHBvc2l0aW9uOiBWZWN0b3IyXHJcblxyXG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgYm9hcmQ6IFNuYWtlQm9hcmQpIHtcclxuXHRcdHRoaXMucG9zaXRpb24gPSB7IHg6IDAsIHk6IDAgfVxyXG5cdFx0dGhpcy5yZWdlbmVyYXRlKClcclxuXHR9XHJcblxyXG5cdHVwZGF0ZSgpIHt9XHJcblxyXG5cdGRyYXcoc2NyZWVuOiBNYXRyaXgpIHtcclxuXHRcdHNjcmVlbi5zZXQodGhpcy5wb3NpdGlvbi54LCB0aGlzLnBvc2l0aW9uLnksIEZPT0RfQ09MT1IpXHJcblx0fVxyXG5cclxuXHR0ZXN0Q29sbGlzaW9uKHBvc2l0aW9uOiBWZWN0b3IyKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5wb3NpdGlvbi54ID09IHBvc2l0aW9uLnggJiYgdGhpcy5wb3NpdGlvbi55ID09IHBvc2l0aW9uLnlcclxuXHR9XHJcblxyXG5cdGhhbmRsZUNvbGxpc2lvbihlbnRpdHk6IEVudGl0eSkge1xyXG5cdFx0aWYgKGVudGl0eSBpbnN0YW5jZW9mIFNuYWtlKSB7XHJcblx0XHRcdGVudGl0eS5ncm93KDEpXHJcblx0XHRcdHRoaXMucmVnZW5lcmF0ZSgpXHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHJlZ2VuZXJhdGUoKSB7XHJcblx0XHRsZXQgbmV3UG9zaXRpb246IFZlY3RvcjJcclxuXHJcblx0XHRkbyB7XHJcblx0XHRcdG5ld1Bvc2l0aW9uID0ge1xyXG5cdFx0XHRcdHg6IE1hdGguZmxvb3IocmFuZG9tSW5SYW5nZSgwLCB0aGlzLmJvYXJkLndpZHRoKSksXHJcblx0XHRcdFx0eTogTWF0aC5mbG9vcihyYW5kb21JblJhbmdlKDAsIHRoaXMuYm9hcmQuaGVpZ2h0KSksXHJcblx0XHRcdH1cclxuXHRcdH0gd2hpbGUgKHRoaXMuYm9hcmQucXVlcnkobmV3UG9zaXRpb24pKVxyXG5cclxuXHRcdHRoaXMucG9zaXRpb24gPSBuZXdQb3NpdGlvblxyXG5cdH1cclxufVxyXG4iLCJpbXBvcnQgeyBNYXRyaXggfSBmcm9tIFwiLi4vbWF0aC9NYXRyaXhcIlxyXG5pbXBvcnQgeyBWZWN0b3IyIH0gZnJvbSBcIi4uL21hdGgvVmVjdG9yMlwiXHJcbmltcG9ydCB7IEVudGl0eSB9IGZyb20gXCIuL0VudGl0eVwiXHJcbmltcG9ydCB7IFNuYWtlQm9hcmQgfSBmcm9tIFwiLi9TbmFrZUJvYXJkXCJcclxuXHJcbmNvbnN0IEFMSVZFX1NOQUtFX0NPTE9SID0gMHgwMGZmMDBcclxuY29uc3QgREVBRF9TTkFLRV9DT0xPUiA9IDB4MDAwMGZmXHJcblxyXG5lbnVtIERpcmVjdGlvbiB7XHJcblx0Tm9uZSxcclxuXHRVcCxcclxuXHREb3duLFxyXG5cdExlZnQsXHJcblx0UmlnaHQsXHJcbn1cclxuXHJcbmNsYXNzIElucHV0QnVmZmVyIHtcclxuXHRwcml2YXRlIGJ1ZmZlcjogRGlyZWN0aW9uW11cclxuXHRwcml2YXRlIHN0YXJ0OiBudW1iZXJcclxuXHRwcml2YXRlIGVuZDogbnVtYmVyXHJcblx0cHJpdmF0ZSBsZW5ndGg6IG51bWJlclxyXG5cclxuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIG1heExlbmd0aDogbnVtYmVyKSB7XHJcblx0XHR0aGlzLmJ1ZmZlciA9IG5ldyBBcnJheShtYXhMZW5ndGgpXHJcblx0XHR0aGlzLnN0YXJ0ID0gMFxyXG5cdFx0dGhpcy5lbmQgPSAwXHJcblx0XHR0aGlzLmxlbmd0aCA9IDBcclxuXHR9XHJcblxyXG5cdGVucXVldWUoaW5wdXQ6IERpcmVjdGlvbikge1xyXG5cdFx0aWYgKHRoaXMuYnVmZmVyW3RoaXMuZW5kIC0gMV0gPT09IGlucHV0KSB7XHJcblx0XHRcdC8vIElucHV0IGlzIHRoZSBzYW1lIGFzIHRoZSBsYXN0IG9uZSwgZGlzY2FyZFxyXG5cdFx0XHRyZXR1cm5cclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5sZW5ndGggPT09IHRoaXMubWF4TGVuZ3RoKSB7XHJcblx0XHRcdC8vIFF1ZXVlIGlzIGZ1bGwsIGRpc2NhcmQgaW5wdXRcclxuXHRcdFx0cmV0dXJuXHJcblx0XHR9XHJcblxyXG5cdFx0Kyt0aGlzLmxlbmd0aFxyXG5cdFx0dGhpcy5idWZmZXJbdGhpcy5lbmRdID0gaW5wdXRcclxuXHRcdHRoaXMuZW5kID0gKHRoaXMuZW5kICsgMSkgJSB0aGlzLm1heExlbmd0aFxyXG5cdH1cclxuXHJcblx0ZGVxdWV1ZSgpOiBEaXJlY3Rpb24gfCB1bmRlZmluZWQge1xyXG5cdFx0aWYgKHRoaXMubGVuZ3RoID09PSAwKSB7XHJcblx0XHRcdHJldHVybiB1bmRlZmluZWRcclxuXHRcdH1cclxuXHJcblx0XHQtLXRoaXMubGVuZ3RoXHJcblx0XHRjb25zdCBpbnB1dCA9IHRoaXMuYnVmZmVyW3RoaXMuc3RhcnRdXHJcblx0XHR0aGlzLnN0YXJ0ID0gKHRoaXMuc3RhcnQgKyAxKSAlIHRoaXMubWF4TGVuZ3RoXHJcblxyXG5cdFx0cmV0dXJuIGlucHV0XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBTbmFrZUJsb2NrIGltcGxlbWVudHMgRW50aXR5IHtcclxuXHRwcml2YXRlIG5leHQ/OiBTbmFrZUJsb2NrXHJcblx0cHJpdmF0ZSBkaXJlY3Rpb246IERpcmVjdGlvbiA9IERpcmVjdGlvbi5Ob25lXHJcblx0cHJpdmF0ZSBpbnB1dEJ1ZmZlcj86IElucHV0QnVmZmVyXHJcblx0cHJpdmF0ZSBhbGl2ZTogYm9vbGVhblxyXG5cclxuXHRjb25zdHJ1Y3RvcihcclxuXHRcdHByaXZhdGUgYm9hcmQ6IFNuYWtlQm9hcmQsXHJcblx0XHRwcml2YXRlIHNuYWtlOiBTbmFrZSxcclxuXHRcdHByaXZhdGUgcG9zaXRpb246IFZlY3RvcjIsXHJcblx0XHRwcml2YXRlIHByZXY/OiBTbmFrZUJsb2NrXHJcblx0KSB7XHJcblx0XHRpZiAoIXByZXYpIHtcclxuXHRcdFx0Ly8gVGhpcyBpcyB0aGUgaGVhZCwgaGFuZGxlIGlucHV0XHJcblx0XHRcdHRoaXMuaW5wdXRCdWZmZXIgPSBuZXcgSW5wdXRCdWZmZXIoMylcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmFsaXZlID0gdHJ1ZVxyXG5cdH1cclxuXHJcblx0dXBkYXRlKCkge1xyXG5cdFx0dGhpcy5wcm9jZXNzSW5wdXQoKVxyXG5cclxuXHRcdGlmICh0aGlzLm5leHQpIHtcclxuXHRcdFx0dGhpcy5uZXh0LnVwZGF0ZSgpXHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuc25ha2UuYWxpdmUpIHtcclxuXHRcdFx0Y29uc3QgY3VycmVudERpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uXHJcblxyXG5cdFx0XHRpZiAodGhpcy5wcmV2KSB7XHJcblx0XHRcdFx0dGhpcy5kaXJlY3Rpb24gPSB0aGlzLnByZXYuZGlyZWN0aW9uXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmIChjdXJyZW50RGlyZWN0aW9uID09PSBEaXJlY3Rpb24uTm9uZSkge1xyXG5cdFx0XHRcdC8vIElmIHRoZSBzbmFrZSBpcyBub3QgbW92aW5nLCBkb24ndCB0ZXN0IGZvciBjb2xsaXNpb25zXHJcblx0XHRcdFx0cmV0dXJuXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGNvbnN0IG5ld1Bvc2l0aW9uID0gdGhpcy5nZXROZXh0UG9zaXRpb24oY3VycmVudERpcmVjdGlvbilcclxuXHJcblx0XHRcdGlmICghdGhpcy5wcmV2KSB7XHJcblx0XHRcdFx0Ly8gVGhpcyBpcyB0aGUgaGVhZCwgY2hlY2sgZm9yIGNvbGxpc2lvbnNcclxuXHRcdFx0XHRjb25zdCBjb2xsaXNpb24gPSB0aGlzLmJvYXJkLnF1ZXJ5KG5ld1Bvc2l0aW9uKVxyXG5cclxuXHRcdFx0XHRpZiAoY29sbGlzaW9uKSB7XHJcblx0XHRcdFx0XHRjb2xsaXNpb24uaGFuZGxlQ29sbGlzaW9uKHRoaXMuc25ha2UpXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aGlzLnBvc2l0aW9uID0gbmV3UG9zaXRpb25cclxuXHRcdH0gZWxzZSBpZiAodGhpcy5hbGl2ZSkge1xyXG5cdFx0XHQvLyBEZWFkIGFuaW1hdGlvblxyXG5cdFx0XHRpZiAodGhpcy5wcmV2KSB7XHJcblx0XHRcdFx0dGhpcy5hbGl2ZSA9IHRoaXMucHJldi5hbGl2ZVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vIFRoaXMgaXMgdGhlIGhlYWRcclxuXHRcdFx0XHR0aGlzLmFsaXZlID0gZmFsc2VcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0ZHJhdyhzY3JlZW46IE1hdHJpeCkge1xyXG5cdFx0c2NyZWVuLnNldChcclxuXHRcdFx0dGhpcy5wb3NpdGlvbi54LFxyXG5cdFx0XHR0aGlzLnBvc2l0aW9uLnksXHJcblx0XHRcdHRoaXMuYWxpdmUgPyBBTElWRV9TTkFLRV9DT0xPUiA6IERFQURfU05BS0VfQ09MT1JcclxuXHRcdClcclxuXHJcblx0XHRpZiAodGhpcy5uZXh0KSB7XHJcblx0XHRcdHRoaXMubmV4dC5kcmF3KHNjcmVlbilcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHRlc3RDb2xsaXNpb24ocG9zaXRpb246IFZlY3RvcjIpOiBib29sZWFuIHtcclxuXHRcdGlmIChwb3NpdGlvbi54ID09PSB0aGlzLnBvc2l0aW9uLnggJiYgcG9zaXRpb24ueSA9PT0gdGhpcy5wb3NpdGlvbi55KSB7XHJcblx0XHRcdHJldHVybiB0cnVlXHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMubmV4dCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5uZXh0LnRlc3RDb2xsaXNpb24ocG9zaXRpb24pXHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGZhbHNlXHJcblx0fVxyXG5cclxuXHRoYW5kbGVDb2xsaXNpb24oZW50aXR5OiBFbnRpdHkpIHtcclxuXHRcdHRoaXMuc25ha2Uua2lsbCgpXHJcblx0XHR0aGlzLmJvYXJkLmxvc2VHYW1lKClcclxuXHR9XHJcblxyXG5cdGhhbmRsZUlucHV0KGtleTogc3RyaW5nKSB7XHJcblx0XHRpZiAoIXRoaXMuaW5wdXRCdWZmZXIpIHtcclxuXHRcdFx0cmV0dXJuXHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IG5ld0RpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uXHJcblxyXG5cdFx0c3dpdGNoIChrZXkpIHtcclxuXHRcdFx0Y2FzZSBcIkFycm93VXBcIjpcclxuXHRcdFx0XHRuZXdEaXJlY3Rpb24gPSBEaXJlY3Rpb24uVXBcclxuXHRcdFx0XHRicmVha1xyXG5cdFx0XHRjYXNlIFwiQXJyb3dEb3duXCI6XHJcblx0XHRcdFx0bmV3RGlyZWN0aW9uID0gRGlyZWN0aW9uLkRvd25cclxuXHRcdFx0XHRicmVha1xyXG5cdFx0XHRjYXNlIFwiQXJyb3dSaWdodFwiOlxyXG5cdFx0XHRcdG5ld0RpcmVjdGlvbiA9IERpcmVjdGlvbi5SaWdodFxyXG5cdFx0XHRcdGJyZWFrXHJcblx0XHRcdGNhc2UgXCJBcnJvd0xlZnRcIjpcclxuXHRcdFx0XHRuZXdEaXJlY3Rpb24gPSBEaXJlY3Rpb24uTGVmdFxyXG5cdFx0XHRkZWZhdWx0OlxyXG5cdFx0XHRcdGJyZWFrXHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5pbnB1dEJ1ZmZlci5lbnF1ZXVlKG5ld0RpcmVjdGlvbilcclxuXHR9XHJcblxyXG5cdGdyb3cobGVuZ3RoOiBudW1iZXIpIHtcclxuXHRcdGlmIChsZW5ndGggPD0gMCkge1xyXG5cdFx0XHRyZXR1cm5cclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5uZXh0KSB7XHJcblx0XHRcdHRoaXMubmV4dC5ncm93KGxlbmd0aClcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMubmV4dCA9IG5ldyBTbmFrZUJsb2NrKFxyXG5cdFx0XHRcdHRoaXMuYm9hcmQsXHJcblx0XHRcdFx0dGhpcy5zbmFrZSxcclxuXHRcdFx0XHR0aGlzLnBvc2l0aW9uLFxyXG5cdFx0XHRcdHRoaXNcclxuXHRcdFx0KVxyXG5cdFx0XHR0aGlzLm5leHQuZ3JvdyhsZW5ndGggLSAxKVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBnZXROZXh0UG9zaXRpb24oZGlyZWN0aW9uOiBEaXJlY3Rpb24pOiBWZWN0b3IyIHtcclxuXHRcdGNvbnN0IG5ld1Bvc2l0aW9uID0geyB4OiB0aGlzLnBvc2l0aW9uLngsIHk6IHRoaXMucG9zaXRpb24ueSB9XHJcblxyXG5cdFx0c3dpdGNoIChkaXJlY3Rpb24pIHtcclxuXHRcdFx0Y2FzZSBEaXJlY3Rpb24uTm9uZTpcclxuXHRcdFx0XHQvLyBEbyBub3RoaW5nXHJcblx0XHRcdFx0YnJlYWtcclxuXHRcdFx0Y2FzZSBEaXJlY3Rpb24uVXA6XHJcblx0XHRcdFx0Ly8gV2l0aCB0aGUgbW9kdWxvIG9wZXJhdGlvbiwgdGhpcyBpcyBlcXVpdmFsZW50IHRvIHN1YnN0cmFjdGluZyAxXHJcblx0XHRcdFx0Ly8gdG8gdGhlIGN1cnJlbnQgcG9zaXRpb24sIHdoaWxlIGF2b2lkaW5nIG5lZ2F0aXZlIG51bWJlcnNcclxuXHRcdFx0XHRuZXdQb3NpdGlvbi55ID1cclxuXHRcdFx0XHRcdChuZXdQb3NpdGlvbi55ICsgdGhpcy5ib2FyZC5oZWlnaHQgLSAxKSAlIHRoaXMuYm9hcmQuaGVpZ2h0XHJcblx0XHRcdFx0YnJlYWtcclxuXHRcdFx0Y2FzZSBEaXJlY3Rpb24uRG93bjpcclxuXHRcdFx0XHRuZXdQb3NpdGlvbi55ID0gKG5ld1Bvc2l0aW9uLnkgKyAxKSAlIHRoaXMuYm9hcmQuaGVpZ2h0XHJcblx0XHRcdFx0YnJlYWtcclxuXHRcdFx0Y2FzZSBEaXJlY3Rpb24uTGVmdDpcclxuXHRcdFx0XHQvLyBXaXRoIHRoZSBtb2R1bG8gb3BlcmF0aW9uLCB0aGlzIGlzIGVxdWl2YWxlbnQgdG8gc3Vic3RyYWN0aW5nIDFcclxuXHRcdFx0XHQvLyB0byB0aGUgY3VycmVudCBwb3NpdGlvbiwgd2hpbGUgYXZvaWRpbmcgbmVnYXRpdmUgbnVtYmVyc1xyXG5cdFx0XHRcdG5ld1Bvc2l0aW9uLnggPVxyXG5cdFx0XHRcdFx0KG5ld1Bvc2l0aW9uLnggKyB0aGlzLmJvYXJkLndpZHRoIC0gMSkgJSB0aGlzLmJvYXJkLndpZHRoXHJcblx0XHRcdFx0YnJlYWtcclxuXHRcdFx0Y2FzZSBEaXJlY3Rpb24uUmlnaHQ6XHJcblx0XHRcdFx0bmV3UG9zaXRpb24ueCA9IChuZXdQb3NpdGlvbi54ICsgMSkgJSB0aGlzLmJvYXJkLndpZHRoXHJcblx0XHRcdFx0YnJlYWtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gbmV3UG9zaXRpb25cclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcHJvY2Vzc0lucHV0KCkge1xyXG5cdFx0aWYgKCF0aGlzLmlucHV0QnVmZmVyKSB7XHJcblx0XHRcdHJldHVyblxyXG5cdFx0fVxyXG5cclxuXHRcdGxldCBuZXh0SW5wdXQgPSB0aGlzLmlucHV0QnVmZmVyLmRlcXVldWUoKVxyXG5cdFx0bGV0IGFjY2VwdGVkSW5wdXQgPSBmYWxzZVxyXG5cclxuXHRcdHdoaWxlIChuZXh0SW5wdXQgJiYgIWFjY2VwdGVkSW5wdXQpIHtcclxuXHRcdFx0Ly8gRG9uJ3QgYWxsb3cgdGhlIHNuYWtlIHRvIGNyYXNoIGludG8gaXRzZWxmIGJ5IHJldmVyc2luZyBpdHNcclxuXHRcdFx0Ly8gbW92ZW1lbnRcclxuXHRcdFx0Y29uc3QgbmV4dFBvc2l0aW9uID0gdGhpcy5nZXROZXh0UG9zaXRpb24obmV4dElucHV0KVxyXG5cclxuXHRcdFx0aWYgKFxyXG5cdFx0XHRcdCF0aGlzLm5leHQgfHxcclxuXHRcdFx0XHR0aGlzLm5leHQucG9zaXRpb24ueCAhPT0gbmV4dFBvc2l0aW9uLnggfHxcclxuXHRcdFx0XHR0aGlzLm5leHQucG9zaXRpb24ueSAhPT0gbmV4dFBvc2l0aW9uLnlcclxuXHRcdFx0KSB7XHJcblx0XHRcdFx0dGhpcy5kaXJlY3Rpb24gPSBuZXh0SW5wdXRcclxuXHRcdFx0XHRhY2NlcHRlZElucHV0ID0gdHJ1ZVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdG5leHRJbnB1dCA9IHRoaXMuaW5wdXRCdWZmZXIuZGVxdWV1ZSgpXHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTbmFrZSBpbXBsZW1lbnRzIEVudGl0eSB7XHJcblx0cHJpdmF0ZSBoZWFkOiBTbmFrZUJsb2NrXHJcblx0cHJpdmF0ZSBfYWxpdmU6IGJvb2xlYW5cclxuXHJcblx0Y29uc3RydWN0b3IocHJpdmF0ZSBib2FyZDogU25ha2VCb2FyZCwgcG9zaXRpb246IFZlY3RvcjIsIGxlbmd0aDogbnVtYmVyKSB7XHJcblx0XHR0aGlzLmhlYWQgPSBuZXcgU25ha2VCbG9jayhib2FyZCwgdGhpcywgcG9zaXRpb24sIHVuZGVmaW5lZClcclxuXHRcdHRoaXMuZ3JvdyhsZW5ndGggLSAxKVxyXG5cclxuXHRcdHRoaXMuX2FsaXZlID0gdHJ1ZVxyXG5cdH1cclxuXHJcblx0Z2V0IGFsaXZlKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2FsaXZlXHJcblx0fVxyXG5cclxuXHR1cGRhdGUoKSB7XHJcblx0XHR0aGlzLmhlYWQudXBkYXRlKClcclxuXHR9XHJcblxyXG5cdGRyYXcoc2NyZWVuOiBNYXRyaXgpIHtcclxuXHRcdHRoaXMuaGVhZC5kcmF3KHNjcmVlbilcclxuXHR9XHJcblxyXG5cdHRlc3RDb2xsaXNpb24ocG9zaXRpb246IFZlY3RvcjIpIHtcclxuXHRcdHJldHVybiB0aGlzLmhlYWQudGVzdENvbGxpc2lvbihwb3NpdGlvbilcclxuXHR9XHJcblxyXG5cdGhhbmRsZUNvbGxpc2lvbihlbnRpdHk6IEVudGl0eSkge1xyXG5cdFx0dGhpcy5oZWFkLmhhbmRsZUNvbGxpc2lvbihlbnRpdHkpXHJcblx0fVxyXG5cclxuXHRoYW5kbGVJbnB1dChrZXk6IHN0cmluZykge1xyXG5cdFx0dGhpcy5oZWFkLmhhbmRsZUlucHV0KGtleSlcclxuXHR9XHJcblxyXG5cdGdyb3cobGVuZ3RoOiBudW1iZXIgPSAxKSB7XHJcblx0XHR0aGlzLmhlYWQuZ3JvdyhsZW5ndGgpXHJcblx0fVxyXG5cclxuXHRraWxsKCkge1xyXG5cdFx0dGhpcy5fYWxpdmUgPSBmYWxzZVxyXG5cdH1cclxufVxyXG4iLCJpbXBvcnQgeyBNYXRyaXggfSBmcm9tIFwiLi4vbWF0aC9NYXRyaXhcIlxyXG5pbXBvcnQgeyBDaHJvbWEgfSBmcm9tIFwiLi4vY2hyb21hL0Nocm9tYVwiXHJcbmltcG9ydCB7IFZlY3RvcjIgfSBmcm9tIFwiLi4vbWF0aC9WZWN0b3IyXCJcclxuaW1wb3J0IHsgRW50aXR5IH0gZnJvbSBcIi4vRW50aXR5XCJcclxuaW1wb3J0IHsgU25ha2UgfSBmcm9tIFwiLi9TbmFrZVwiXHJcbmltcG9ydCB7IEZvb2QgfSBmcm9tIFwiLi9Gb29kXCJcclxuXHJcbmVudW0gR2FtZVN0YXRlIHtcclxuXHRTdG9wcGVkLFxyXG5cdFBsYXlpbmcsXHJcblx0R2FtZU92ZXIsXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTbmFrZUJvYXJkIHtcclxuXHRwcml2YXRlIHN0YXRlOiBHYW1lU3RhdGVcclxuXHRwcml2YXRlIGVudGl0aWVzOiBFbnRpdHlbXVxyXG5cdHByaXZhdGUgc2NyZWVuOiBNYXRyaXhcclxuXHJcblx0cHJpdmF0ZSBpbnRlcnZhbD86IFJldHVyblR5cGU8dHlwZW9mIHNldFRpbWVvdXQ+XHJcblx0cHJpdmF0ZSBpbnB1dEFib3J0Q29udHJvbGxlcj86IEFib3J0Q29udHJvbGxlclxyXG5cclxuXHRjb25zdHJ1Y3RvcihcclxuXHRcdHByaXZhdGUgY2hyb21hOiBDaHJvbWEsXHJcblx0XHRwcml2YXRlIF93aWR0aDogbnVtYmVyLFxyXG5cdFx0cHJpdmF0ZSBfaGVpZ2h0OiBudW1iZXIsXHJcblx0XHRwcml2YXRlIG9mZnNldFg6IG51bWJlcixcclxuXHRcdHByaXZhdGUgb2Zmc2V0WTogbnVtYmVyXHJcblx0KSB7XHJcblx0XHR0aGlzLmVudGl0aWVzID0gW11cclxuXHRcdHRoaXMuc3RhdGUgPSBHYW1lU3RhdGUuU3RvcHBlZFxyXG5cdFx0dGhpcy5zY3JlZW4gPSBuZXcgTWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KVxyXG5cdH1cclxuXHJcblx0Z2V0IHdpZHRoKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX3dpZHRoXHJcblx0fVxyXG5cclxuXHRnZXQgaGVpZ2h0KCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2hlaWdodFxyXG5cdH1cclxuXHJcblx0dXBkYXRlKCkge1xyXG5cdFx0dGhpcy5lbnRpdGllcy5mb3JFYWNoKChlbnRpdHkpID0+IGVudGl0eS51cGRhdGUoKSlcclxuXHR9XHJcblxyXG5cdGRyYXcoKSB7XHJcblx0XHR0aGlzLnNjcmVlbi5jbGVhcigpXHJcblxyXG5cdFx0dGhpcy5lbnRpdGllcy5mb3JFYWNoKChlbnRpdHkpID0+IGVudGl0eS5kcmF3KHRoaXMuc2NyZWVuKSlcclxuXHJcblx0XHR0aGlzLmNocm9tYS5kcmF3S2V5Ym9hcmQodGhpcy5zY3JlZW4sIHRoaXMub2Zmc2V0WCwgdGhpcy5vZmZzZXRZKVxyXG5cdH1cclxuXHJcblx0cXVlcnkocG9zaXRpb246IFZlY3RvcjIpOiBFbnRpdHkgfCB1bmRlZmluZWQge1xyXG5cdFx0cmV0dXJuIHRoaXMuZW50aXRpZXMuZmluZCgoZW50aXR5KSA9PiBlbnRpdHkudGVzdENvbGxpc2lvbihwb3NpdGlvbikpXHJcblx0fVxyXG5cclxuXHRzdGFydEdhbWUoKSB7XHJcblx0XHRpZiAodGhpcy5zdGF0ZSAhPT0gR2FtZVN0YXRlLlN0b3BwZWQpIHtcclxuXHRcdFx0dGhpcy5zdG9wR2FtZSgpXHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5lbnRpdGllcyA9IFtcclxuXHRcdFx0bmV3IFNuYWtlKHRoaXMsIHsgeDogMSwgeTogTWF0aC5mbG9vcih0aGlzLmhlaWdodCAvIDIpIH0sIDMpLFxyXG5cdFx0XHRuZXcgRm9vZCh0aGlzKSxcclxuXHRcdF1cclxuXHJcblx0XHR0aGlzLnN0YXRlID0gR2FtZVN0YXRlLlBsYXlpbmdcclxuXHJcblx0XHR0aGlzLmlucHV0QWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpXHJcblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFxyXG5cdFx0XHRcImtleWRvd25cIixcclxuXHRcdFx0KGV2ZW50KSA9PiB7XHJcblx0XHRcdFx0aWYgKGV2ZW50LmtleSA9PT0gXCJCYWNrc3BhY2VcIikge1xyXG5cdFx0XHRcdFx0Ly8gUmVzdGFydCB0aGUgZ2FtZSBvbiBiYWNrc3BhY2VcclxuXHRcdFx0XHRcdHRoaXMuc3RhcnRHYW1lKClcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dGhpcy5lbnRpdGllcy5mb3JFYWNoKChlbnRpdHkpID0+IHtcclxuXHRcdFx0XHRcdFx0aWYgKGVudGl0eS5oYW5kbGVJbnB1dCkge1xyXG5cdFx0XHRcdFx0XHRcdGVudGl0eS5oYW5kbGVJbnB1dChldmVudC5rZXkpXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0XHR7IHNpZ25hbDogdGhpcy5pbnB1dEFib3J0Q29udHJvbGxlci5zaWduYWwgfVxyXG5cdFx0KVxyXG5cclxuXHRcdHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcblx0XHRcdHRoaXMudXBkYXRlKClcclxuXHRcdFx0dGhpcy5kcmF3KClcclxuXHRcdH0sIDIwMClcclxuXHR9XHJcblxyXG5cdHN0b3BHYW1lKCkge1xyXG5cdFx0dGhpcy5zdGF0ZSA9IEdhbWVTdGF0ZS5TdG9wcGVkXHJcblxyXG5cdFx0aWYgKHRoaXMuaW5wdXRBYm9ydENvbnRyb2xsZXIpIHtcclxuXHRcdFx0dGhpcy5pbnB1dEFib3J0Q29udHJvbGxlci5hYm9ydCgpXHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuaW50ZXJ2YWwpIHtcclxuXHRcdFx0Y2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKVxyXG5cdFx0XHR0aGlzLmludGVydmFsID0gdW5kZWZpbmVkXHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRsb3NlR2FtZSgpIHtcclxuXHRcdHRoaXMuc3RhdGUgPSBHYW1lU3RhdGUuR2FtZU92ZXJcclxuXHR9XHJcbn1cclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MDcpO1xuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwidGhpcyIsImtleWJvYXJkIiwiTWF0cml4IiwiaW5pdCIsImluaXRPcHRpb25zIiwidXJpIiwicmVzcG9uc2UiLCJyZXF1ZXN0IiwidXJsIiwiYm9keSIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJhdXRob3IiLCJuYW1lIiwiYXV0aG9yTmFtZSIsImNvbnRhY3QiLCJhdXRob3JDb250YWN0IiwiZGV2aWNlX3N1cHBvcnRlZCIsInN1cHBvcnRlZERldmljZXMiLCJjYXRlZ29yeSIsInNlc3Npb25JZCIsInNlc3Npb25pZCIsImludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJtZXRob2QiLCJwYXRoIiwiZXJyb3IiLCJjb25zb2xlIiwidW5pbml0aWFsaXplIiwiY2xlYXJJbnRlcnZhbCIsImRyYXdLZXlib2FyZCIsImltYWdlIiwib2Zmc2V0WCIsIm9mZnNldFkiLCJjbGVhciIsImNvcHkiLCJlZmZlY3QiLCJwYXJhbSIsImRhdGEiLCJvcHRpb25zIiwicmVxdWVzdEluaXQiLCJoZWFkZXJzIiwiSlNPTiIsInN0cmluZ2lmeSIsImZldGNoIiwianNvbiIsImNocm9tYSIsIkNocm9tYSIsIlNuYWtlQm9hcmQiLCJzdGFydEdhbWUiLCJ3aWR0aCIsImhlaWdodCIsImZpbGxWYWx1ZSIsIl9kYXRhIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwieSIsIngiLCJzZXQiLCJ2YWx1ZSIsIm1hdHJpeCIsImZvckVhY2giLCJyb3ciLCJyYW5kb21JblJhbmdlIiwic3RhcnQiLCJlbmQiLCJNYXRoIiwicmFuZG9tIiwiYm9hcmQiLCJwb3NpdGlvbiIsInJlZ2VuZXJhdGUiLCJ1cGRhdGUiLCJkcmF3Iiwic2NyZWVuIiwidGVzdENvbGxpc2lvbiIsImhhbmRsZUNvbGxpc2lvbiIsImVudGl0eSIsIlNuYWtlIiwiZ3JvdyIsIm5ld1Bvc2l0aW9uIiwiZmxvb3IiLCJxdWVyeSIsIkRpcmVjdGlvbiIsIklucHV0QnVmZmVyIiwibWF4TGVuZ3RoIiwiYnVmZmVyIiwibGVuZ3RoIiwiZW5xdWV1ZSIsImlucHV0IiwiZGVxdWV1ZSIsIlNuYWtlQmxvY2siLCJzbmFrZSIsInByZXYiLCJkaXJlY3Rpb24iLCJOb25lIiwiaW5wdXRCdWZmZXIiLCJhbGl2ZSIsInByb2Nlc3NJbnB1dCIsIm5leHQiLCJjdXJyZW50RGlyZWN0aW9uIiwiZ2V0TmV4dFBvc2l0aW9uIiwiY29sbGlzaW9uIiwia2lsbCIsImxvc2VHYW1lIiwiaGFuZGxlSW5wdXQiLCJrZXkiLCJuZXdEaXJlY3Rpb24iLCJVcCIsIkRvd24iLCJSaWdodCIsIkxlZnQiLCJuZXh0SW5wdXQiLCJhY2NlcHRlZElucHV0IiwibmV4dFBvc2l0aW9uIiwiaGVhZCIsInVuZGVmaW5lZCIsIl9hbGl2ZSIsIkdhbWVTdGF0ZSIsIl93aWR0aCIsIl9oZWlnaHQiLCJlbnRpdGllcyIsInN0YXRlIiwiU3RvcHBlZCIsImZpbmQiLCJzdG9wR2FtZSIsIkZvb2QiLCJQbGF5aW5nIiwiaW5wdXRBYm9ydENvbnRyb2xsZXIiLCJBYm9ydENvbnRyb2xsZXIiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInNpZ25hbCIsImFib3J0IiwiR2FtZU92ZXIiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiXSwic291cmNlUm9vdCI6IiJ9